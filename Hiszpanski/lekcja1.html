<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HiszpaÅ„ski: WyglÄ…d i Charakter (PeÅ‚ny)</title>
    <style>
        /* STYL GÅÃ“WNY - FIESTA VIZUALNA 5.1 */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fff3e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            text-align: center;
            color: #3e2723;
        }

        #container {
            background-color: white;
            padding: 30px;
            border-radius: 30px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            width: 95%;
            max-width: 800px;
            border: 5px solid #ff6f00;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }

        h1 { margin: 10px 0 20px 0; font-size: 32px; color: #e65100; }
        h2 { color: #ef6c00; margin-top: 20px; border-bottom: 2px solid #ffe0b2; display: inline-block; padding-bottom: 5px;}
        p { font-size: 18px; margin-bottom: 20px; }

        /* TABELA DO NAUKI */
        .study-table {
            width: 100%;
            margin-bottom: 30px;
            text-align: left;
            border-collapse: collapse;
        }
        .study-row {
            display: flex;
            align-items: center;
            background-color: #fff8e1;
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 15px;
            border-left: 8px solid #ffca28;
            font-size: 18px;
        }
        .study-row .emoji { font-size: 24px; margin-right: 15px; width: 40px; text-align: center;}
        .study-row .es { font-weight: bold; color: #d84315; flex: 1; font-size: 20px;}
        .study-row .pl { color: #555; flex: 1; font-style: italic; font-size: 18px;}

        /* PRZYCISKI */
        .btn-big {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 20px 30px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #e65100;
            transition: 0.2s;
            margin: 20px 0;
            width: 100%;
            white-space: normal;
        }
        .btn-big:active { transform: translateY(4px); box-shadow: none; }
        .btn-next { background-color: #43a047; box-shadow: 0 6px 0 #2e7d32; }
        .btn-grammar { background-color: #0288d1; box-shadow: 0 6px 0 #01579b; }

        /* FISZKI */
        .flashcard-scene { width: 100%; height: 350px; perspective: 1000px; margin-bottom: 30px; cursor: pointer;}
        .flashcard { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.6s; }
        .flashcard.flipped { transform: rotateY(180deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            border-radius: 20px; padding: 20px; box-sizing: border-box;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border: 4px solid #ff9800;
        }
        .front { background-color: #fff8e1; color: #bf360c; }
        .back { background-color: #e8f5e9; color: #1b5e20; transform: rotateY(180deg); }
        .emoji-big { font-size: 80px; margin-bottom: 20px; }
        .term { font-size: 40px; font-weight: bold; margin-bottom: 10px; }
        .def { font-size: 28px; font-weight: bold; }

        /* TRENING ZDAÅƒ (Nowy Styl) */
        .sentence-box {
            background-color: #e1f5fe;
            padding: 20px;
            border-radius: 20px;
            font-size: 26px;
            font-weight: bold;
            color: #01579b;
            margin-bottom: 30px;
            border: 3px solid #0288d1;
        }
        .gap {
            display: inline-block;
            width: 100px;
            border-bottom: 3px solid #01579b;
            text-align: center;
            color: #d84315;
        }

        /* QUIZ GRID */
        .quiz-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 25px; 
            width: 100%; 
        }
        .quiz-btn {
            background-color: #ffe0b2; border: none; padding: 15px;
            font-size: 20px; border-radius: 20px; cursor: pointer; color: #bf360c; font-weight: 700;
            box-shadow: 0 5px 0 #ffcc80;
            min-height: 80px; display: flex; align-items: center; justify-content: center;
        }
        .quiz-btn:hover { background-color: #ffcc80; }
        .correct { background-color: #66bb6a !important; color: white !important; box-shadow: 0 5px 0 #2e7d32 !important;}
        .wrong { background-color: #ef5350 !important; color: white !important; opacity: 0.5; }

        .hidden { display: none !important; }
        .small-text { font-size: 14px; color: #888; margin-top: 10px; }

    </style>
</head>
<body>

<div id="container">
    
    <div id="step-start">
        <h1>Â¡Hola Julia! ğŸ‡ªğŸ‡¸</h1>
        <p>Baza sÅ‚Ã³wek zostaÅ‚a powiÄ™kszona o materiaÅ‚ z podrÄ™cznika.</p>
        
        <div id="study-list"></div>
        
        <button class="btn-big btn-next" onclick="goToFlashcards()">PrzeczytaÅ‚am, idziemy do Fiszek â¡</button>
    </div>

    <div id="step-flashcards" class="hidden">
        <h2>Trening Wzrokowy</h2>
        <div class="flashcard-scene" onclick="flipCard()">
            <div class="flashcard" id="card">
                <div class="card-face front">
                    <div class="emoji-big" id="fc-emoji"></div>
                    <div class="term" id="fc-es">...</div>
                    <div class="small-text">Kliknij, by zobaczyÄ‡ tÅ‚umaczenie</div>
                </div>
                <div class="card-face back">
                    <div class="def" id="fc-pl">...</div>
                </div>
            </div>
        </div>

        <button class="btn-big btn-next" onclick="nextCard()">NastÄ™pne SÅ‚owo â¡</button>
        <br>
        <button class="btn-big btn-grammar" onclick="startSentenceTraining()">IdÅº do ZadaÅ„ ze ZdaÅ„ âœï¸</button>
    </div>

    <div id="step-sentences" class="hidden">
        <h2>UzupeÅ‚nij Zdanie</h2>
        <p>Wybierz: Jest (Es), Ma (Tiene) czy Nosi (Lleva)?</p>
        
        <div class="sentence-box" id="sentence-display">
            ...
        </div>

        <div class="quiz-grid" id="sentence-options"></div>
        <h3 id="s-feedback" style="min-height: 30px;"></h3>

        <button id="next-s-btn" class="btn-big btn-next hidden" onclick="nextSentence()">NastÄ™pne Zdanie â¡</button>
    </div>

    <div id="step-quiz" class="hidden">
        <div id="progress" style="font-weight:bold; color:#e65100;">Pytanie 1</div>
        <div class="emoji-big" id="q-emoji"></div>
        <h2 id="q-text" style="font-size: 36px; margin: 10px 0;">...</h2>
        
        <div class="quiz-grid" id="q-options"></div>
        <h3 id="feedback" style="min-height: 40px; font-size: 24px;"></h3>
        
        <button id="next-q-btn" class="btn-big btn-next hidden" onclick="nextQuestion()">Dalej â¡</button>
    </div>

    <div id="step-end" class="hidden">
        <h1>Â¡Felicidades! ğŸ‰</h1>
        <p>PrzeszÅ‚aÅ› caÅ‚y materiaÅ‚: SÅ‚Ã³wka + Gramatyka.</p>
        <br>
        <button class="btn-big" onclick="location.reload()">PowtÃ³rz wszystko â†º</button>
        <br>
        <a href="../index.html" class="btn-big" style="background-color: #555; text-decoration: none; display: block; text-align: center;">WrÃ³Ä‡ do Menu</a>
    </div>

</div>

<script>
    // --- 1. PEÅNA BAZA SÅÃ“WEK (UZUPEÅNIONA O PDF) ---
    const vocab = [
        // CAT 1: WÅOSY I OCZY (SzczegÃ³Å‚y)
        { es: "Moreno", pl: "Brunet / CiemnowÅ‚osy", em: "ğŸ‘¦ğŸ½", cat: 1 },
        { es: "Rubio", pl: "Blondyn", em: "ğŸ‘±â€â™‚ï¸", cat: 1 },
        { es: "Pelirrojo", pl: "Rudy", em: "ğŸ‘¨â€ğŸ¦°", cat: 1 },
        { es: "Calvo", pl: "Åysy", em: "ğŸ‘¨â€ğŸ¦²", cat: 1 },
        { es: "Pelo liso", pl: "Proste wÅ‚osy", em: "ğŸ‘©â€ğŸ¦°", cat: 1 },
        { es: "Pelo rizado", pl: "KrÄ™cone wÅ‚osy", em: "ğŸ‘©â€ğŸ¦±", cat: 1 },
        { es: "Pelo corto", pl: "KrÃ³tkie wÅ‚osy", em: "ğŸ§’", cat: 1 },
        { es: "Pelo largo", pl: "DÅ‚ugie wÅ‚osy", em: "ğŸ‘©", cat: 1 },
        { es: "Pelo castaÃ±o", pl: "BrÄ…zowe wÅ‚osy (Szatyn)", em: "ğŸŸ¤", cat: 1 }, // NOWE
        { es: "Pelo blanco", pl: "Siwe/BiaÅ‚e wÅ‚osy", em: "ğŸ‘´", cat: 1 }, // NOWE
        { es: "Ojos azules", pl: "Niebieskie oczy", em: "ğŸ”µ", cat: 1 }, // NOWE
        { es: "Ojos verdes", pl: "Zielone oczy", em: "ğŸŸ¢", cat: 1 }, // NOWE
        { es: "Ojos marrones", pl: "BrÄ…zowe oczy", em: "ğŸŸ¤", cat: 1 }, // NOWE
        { es: "Ojos negros", pl: "Czarne oczy", em: "âš«", cat: 1 }, // NOWE

        // CAT 2: WYGLÄ„D OGÃ“LNY I CIAÅO (UzupeÅ‚nione pary)
        { es: "Barba", pl: "Broda", em: "ğŸ§”", cat: 2 },
        { es: "Bigote", pl: "WÄ…sy", em: "ğŸ‘¨", cat: 2 },
        { es: "Gafas", pl: "Okulary", em: "ğŸ‘“", cat: 2 }, // NOWE
        { es: "Alto", pl: "Wysoki", em: "ğŸ¦’", cat: 2 }, // NOWE
        { es: "Bajo", pl: "Niski", em: "ğŸœ", cat: 2 }, // NOWE
        { es: "Gordo", pl: "Gruby", em: "ğŸ˜", cat: 2 }, // NOWE
        { es: "Delgado", pl: "SzczupÅ‚y", em: "ğŸ‹", cat: 2 }, // NOWE
        { es: "Guapo", pl: "Åadny/Przystojny", em: "ğŸ˜", cat: 2 }, // NOWE
        { es: "Feo", pl: "Brzydki", em: "ğŸ‘¹", cat: 2 }, // NOWE
        { es: "Joven", pl: "MÅ‚ody", em: "ğŸ‘¶", cat: 2 }, // NOWE
        { es: "Mayor", pl: "Starszy", em: "ğŸ‘µ", cat: 2 }, // NOWE

        // CAT 3: CHARAKTER (UzupeÅ‚nione)
        { es: "Amable", pl: "MiÅ‚y", em: "ğŸ˜Š", cat: 3 },
        { es: "Desagradable", pl: "Nieprzyjemny", em: "ğŸ˜ ", cat: 3 }, // NOWE
        { es: "Optimista", pl: "Optymista", em: "ğŸŒ", cat: 3 },
        { es: "Pesimista", pl: "Pesymista", em: "ğŸŒ§ï¸", cat: 3 },
        { es: "Gracioso", pl: "Zabawny", em: "ğŸ˜‚", cat: 3 },
        { es: "Aburrido", pl: "Nudny", em: "ğŸ¥±", cat: 3 }, // NOWE
        { es: "Impaciente", pl: "Niecierpliwy", em: "ğŸ˜¤", cat: 3 },
        { es: "Serio", pl: "PowaÅ¼ny", em: "ğŸ˜", cat: 3 },
        { es: "AntipÃ¡tico", pl: "Niesympatyczny", em: "ğŸ˜’", cat: 3 },
        { es: "TÃ­mido", pl: "NieÅ›miaÅ‚y", em: "ğŸ«£", cat: 3 },
        { es: "Introvertido", pl: "Introwertyk", em: "ğŸ˜¶", cat: 3 }
    ];

    // --- 2. BAZA ZDAÅƒ (GRAMATYKA Z PDF) ---
    // Klucz: es (jest), tiene (ma), lleva (nosi), soy (jestem), tengo (mam)
    const sentences = [
        { s: "Ella ___ rubia.", ans: "Es", opts: ["Es", "Tiene", "Lleva"] }, // Opis
        { s: "Ella ___ el pelo rubio.", ans: "Tiene", opts: ["Es", "Tiene", "Lleva"] }, // Posiadanie
        { s: "Ã‰l ___ bigote.", ans: "Tiene", opts: ["Es", "Tiene", "Soy"] },
        { s: "Mi abuelo ___ mayor.", ans: "Es", opts: ["Es", "Tiene", "Lleva"] },
        { s: "Ana ___ gafas.", ans: "Lleva", opts: ["Es", "Tiene", "Lleva"] }, // Akcesoria
        { s: "El chico ___ alto y guapo.", ans: "Es", opts: ["Es", "Tiene", "Lleva"] },
        { s: "Nosotros ___ los ojos azules.", ans: "Tenemos", opts: ["Tenemos", "Somos", "Tienen"] }, // Odmiana
        { s: "(Ja) ___ un perro.", ans: "Tengo", opts: ["Tengo", "Tiene", "Soy"] }, // Odmiana
        { s: "Vosotros ___ el pelo corto.", ans: "TenÃ©is", opts: ["TenÃ©is", "Sois", "Tienen"] }, // Odmiana
        { s: "La chica ___ delgada.", ans: "Es", opts: ["Es", "Tiene", "Lleva"] }
    ];

    // --- GENEROWANIE TABELI ---
    function renderStudyList() {
        const container = document.getElementById('study-list');
        const cats = {1: "WÅ‚osy i Oczy", 2: "WyglÄ…d i CiaÅ‚o", 3: "Charakter"};
        
        for (let c = 1; c <= 3; c++) {
            const section = document.createElement('div');
            section.innerHTML = `<h3>${cats[c]}</h3>`;
            vocab.filter(v => v.cat === c).forEach(word => {
                const row = document.createElement('div');
                row.className = 'study-row';
                row.innerHTML = `<div class="emoji">${word.em}</div><div class="es">${word.es}</div><div class="pl">${word.pl}</div>`;
                section.appendChild(row);
            });
            container.appendChild(section);
        }
    }

    // --- FISZKI ---
    let fcIndex = 0;
    function goToFlashcards() {
        document.getElementById('step-start').classList.add('hidden');
        document.getElementById('step-flashcards').classList.remove('hidden');
        window.scrollTo(0,0);
        loadFlashcard();
    }
    function loadFlashcard() {
        const c = document.getElementById('card');
        c.classList.remove('flipped');
        const item = vocab[fcIndex];
        setTimeout(() => {
            document.getElementById('fc-emoji').innerText = item.em;
            document.getElementById('fc-es').innerText = item.es;
            document.getElementById('fc-pl').innerText = item.pl;
        }, 200);
    }
    function flipCard() { document.getElementById('card').classList.toggle('flipped'); }
    function nextCard() { fcIndex = (fcIndex + 1) % vocab.length; loadFlashcard(); }

    // --- TRENING ZDAÅƒ (NOWY MODUÅ) ---
    let sIndex = 0;
    let sData = [];

    function startSentenceTraining() {
        document.getElementById('step-flashcards').classList.add('hidden');
        document.getElementById('step-sentences').classList.remove('hidden');
        window.scrollTo(0,0);
        sData = sentences.sort(() => 0.5 - Math.random()); // Mieszamy zdania
        loadSentence();
    }

    function loadSentence() {
        if(sIndex >= sData.length) {
            // Koniec zdaÅ„ -> idziemy do Quizu
            startQuiz();
            return;
        }
        const item = sData[sIndex];
        document.getElementById('sentence-display').innerHTML = item.s.replace('___', '<span class="gap">?</span>');
        document.getElementById('s-feedback').innerText = "";
        document.getElementById('next-s-btn').classList.add('hidden');
        
        const grid = document.getElementById('sentence-options');
        grid.innerHTML = "";
        
        // Mieszamy opcje
        const mixedOpts = [...item.opts].sort(() => 0.5 - Math.random());
        
        mixedOpts.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'quiz-btn';
            btn.innerText = opt;
            btn.onclick = () => checkSentence(opt === item.ans, btn, item.ans, item.s);
            grid.appendChild(btn);
        });
    }

    function checkSentence(isCorrect, btn, correctTxt, fullSentence) {
        const btns = document.querySelectorAll('.quiz-btn');
        btns.forEach(b => b.onclick = null);

        if(isCorrect) {
            btn.classList.add('correct');
            document.getElementById('s-feedback').innerText = "Brawo! " + fullSentence.replace('___', correctTxt);
            document.getElementById('s-feedback').style.color = "green";
        } else {
            btn.classList.add('wrong');
            btns.forEach(b => { if(b.innerText === correctTxt) b.classList.add('correct'); });
            document.getElementById('s-feedback').innerText = "Å¹le. Poprawnie: " + fullSentence.replace('___', correctTxt);
            document.getElementById('s-feedback').style.color = "red";
        }
        document.getElementById('next-s-btn').classList.remove('hidden');
    }

    function nextSentence() {
        sIndex++;
        loadSentence();
    }


    // --- QUIZ KOÅƒCOWY ---
    let qIndex = 0;
    let quizData = [];

    function startQuiz() {
        document.getElementById('step-sentences').classList.add('hidden');
        document.getElementById('step-quiz').classList.remove('hidden');
        window.scrollTo(0,0);
        
        quizData = vocab.map(item => {
            const distractors = vocab
                .filter(v => v.es !== item.es)
                .sort(() => 0.5 - Math.random())
                .slice(0, 3)
                .map(v => v.pl);
            return {
                q: item.es,
                emoji: item.em,
                correct: item.pl,
                options: [item.pl, ...distractors].sort(() => 0.5 - Math.random())
            };
        }).sort(() => 0.5 - Math.random());

        loadQuestion();
    }

    function loadQuestion() {
        if(qIndex >= quizData.length) {
            document.getElementById('step-quiz').classList.add('hidden');
            document.getElementById('step-end').classList.remove('hidden');
            return;
        }
        const q = quizData[qIndex];
        document.getElementById('progress').innerText = `Pytanie ${qIndex+1} z ${quizData.length}`;
        document.getElementById('q-text').innerText = q.q;
        document.getElementById('q-emoji').innerText = q.emoji;
        document.getElementById('feedback').innerText = "";
        document.getElementById('next-q-btn').classList.add('hidden');

        const grid = document.getElementById('q-options');
        grid.innerHTML = "";
        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'quiz-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(opt === q.correct, btn, q.correct);
            grid.appendChild(btn);
        });
    }

    function checkAnswer(isCorrect, btn, correctTxt) {
        const btns = document.querySelectorAll('.quiz-btn');
        btns.forEach(b => b.onclick = null);
        if(isCorrect) {
            btn.classList.add('correct');
            document.getElementById('feedback').innerText = "Super! ğŸ‘";
            document.getElementById('feedback').style.color = "green";
        } else {
            btn.classList.add('wrong');
            btns.forEach(b => { if(b.innerText === correctTxt) b.classList.add('correct'); });
            document.getElementById('feedback').innerText = "PomyÅ‚ka.";
            document.getElementById('feedback').style.color = "red";
        }
        document.getElementById('next-q-btn').classList.remove('hidden');
    }

    function nextQuestion() {
        qIndex++;
        loadQuestion();
    }

    // Init
    renderStudyList();

</script>

</body>
</html>
