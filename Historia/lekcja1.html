<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historia: Protok√≥≈Ç 3.0 (G≈Çosy)</title>
    <style>
        /* STYL G≈Å√ìWNY - MOTYW HISTORYCZNY */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fdf5e6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
            color: #3e2723;
        }

        #container {
            background-color: white;
            padding: 30px;
            border-radius: 30px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
            width: 95%;
            max-width: 800px;
            border: 4px solid #8d6e63;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        h1 { margin: 0 0 20px 0; font-size: 32px; color: #5d4037; }
        p { font-size: 20px; margin-bottom: 30px; line-height: 1.5; }

        /* PRZYCISKI */
        .btn-big {
            background-color: #8d6e63;
            color: white;
            border: none;
            padding: 20px 30px;
            font-size: 22px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #5d4037;
            transition: 0.2s;
            margin: 10px;
            width: 90%;
            white-space: normal;
        }
        .btn-big:active { transform: translateY(4px); box-shadow: none; }
        .btn-big:hover { background-color: #6d4c41; }
        
        .btn-action { background-color: #ffb74d; box-shadow: 0 6px 0 #f57c00; color: #3e2723; }
        .btn-action:hover { background-color: #ffa726; }

        .btn-voice { background-color: #5d4037; font-size: 16px; padding: 15px 25px; width: auto; display: inline-block; }

        /* FISZKI */
        .flashcard-scene { width: 100%; height: 320px; perspective: 1000px; margin-bottom: 20px; cursor: pointer;}
        .flashcard { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.6s; }
        .flashcard.flipped { transform: rotateY(180deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            border-radius: 20px; padding: 20px; box-sizing: border-box;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border: 2px solid #8d6e63;
        }
        .front { background-color: #a1887f; color: white; }
        .back { background-color: #efebe9; color: #3e2723; transform: rotateY(180deg); }
        .term { font-size: 32px; font-weight: bold; }
        .def { font-size: 22px; line-height: 1.4; }

        /* QUIZ */
        .quiz-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; }
        .quiz-btn {
            background-color: #d7ccc8; border: none; padding: 15px;
            font-size: 18px; border-radius: 15px; cursor: pointer; color: #3e2723; font-weight: 600;
            box-shadow: 0 4px 0 #a1887f;
        }
        .quiz-btn:hover { background-color: #bcaaa4; }
        .correct { background-color: #66bb6a !important; color: white; box-shadow: 0 4px 0 #2e7d32 !important;}
        .wrong { background-color: #ef5350 !important; color: white; opacity: 0.5; }

        .hidden { display: none !important; }
        .small-btn { padding: 10px 20px; font-size: 16px; border-radius: 20px; background: #8d6e63; color: white; border: none; cursor: pointer; margin-top: 10px;}

        @media (max-width: 768px) {
            .quiz-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div id="container">
    
    <div id="step-start">
        <h1>Historia: Po Powstaniu üìú</h1>
        <p>Polacy kontra zaborcy. Walka bez broni, czyli praca organiczna i spryt.</p>
        
        <button class="btn-big" onclick="playAudio('intro')">üì¢ Pos≈Çuchaj Wstƒôpu</button>
        <br>
        <button class="btn-big btn-voice" onclick="toggleVoice()">üó£Ô∏è Zmie≈Ñ G≈Ços (Klikaj a≈º trafisz)</button>
        <div id="voice-info" style="font-size: 14px; margin-top: 5px; color: #8d6e63;"></div>
        <br><br>
        <button class="btn-big btn-action" onclick="goToFlashcards()">Przejd≈∫ do Nauki (Fiszki) ‚û°</button>
    </div>

    <div id="step-flashcards" class="hidden">
        <h2>Trening Pojƒôƒá</h2>
        <p style="font-size: 16px; margin-bottom: 5px;">Kliknij kartƒô, aby obr√≥ciƒá i us≈Çyszeƒá definicjƒô.</p>
        
        <div class="flashcard-scene" onclick="flipCard()">
            <div class="flashcard" id="card">
                <div class="card-face front">
                    <div class="term" id="fc-term">...</div>
                    <div style="margin-top:20px; font-size: 30px;">üîÑ</div>
                </div>
                <div class="card-face back">
                    <div class="def" id="fc-def">...</div>
                </div>
            </div>
        </div>

        <button class="small-btn" onclick="nextCard()">Nastƒôpne Pojƒôcie ‚û°</button>
        <br><br>
        <button class="btn-big btn-action" onclick="goToSummary()">Ju≈º umiem! Idƒô do Testu üìù</button>
    </div>

    <div id="step-summary" class="hidden">
        <h1>Ostatnia prosta!</h1>
        <p>Hania (lub Lektor) podsumuje teraz 3 zabory w pigu≈Çce.</p>
        <button class="btn-big" onclick="playAudio('summary')">üì¢ Pos≈Çuchaj Podsumowania</button>
        <br><br>
        <button class="btn-big btn-action" onclick="startQuiz()">ROZPOCZNIJ QUIZ üöÄ</button>
    </div>

    <div id="step-quiz" class="hidden">
        <div id="progress" style="font-weight:bold; color:#8d6e63;">Pytanie 1</div>
        <h2 id="q-text" style="margin: 15px 0; min-height: 70px;">...</h2>
        <div class="quiz-grid" id="q-options"></div>
        <h3 id="feedback" style="min-height: 30px; margin-top:10px;"></h3>
        <button id="next-q-btn" class="btn-big btn-action hidden" onclick="nextQuestion()">Dalej ‚û°</button>
    </div>

    <div id="step-end" class="hidden">
        <h1>Zwyciƒôstwo! üèÜ</h1>
        <p>Przesz≈Ça≈õ przez rusyfikacjƒô i germanizacjƒô zwyciƒôsko!</p>
        <button class="btn-big" onclick="playAudio('outro')">üì¢ Pos≈Çuchaj na koniec</button>
        <br><br>
        <button class="small-btn" onclick="location.reload()">Powt√≥rz od poczƒÖtku ‚Ü∫</button>
    </div>

</div>

<script>
    // --- DANE: FISZKI ---
    const flashcards = [
        { t: "RUSYFIKACJA", d: "Zmuszanie Polak√≥w do m√≥wienia po rosyjsku i przejmowania rosyjskiej kultury. Symbol: kurator Apuchtin." },
        { t: "KULTURKAMPF", d: "Walka o kulturƒô w zaborze pruskim. Niemcy walczyli z Ko≈õcio≈Çem katolickim i polsko≈õciƒÖ." },
        { t: "AUTONOMIA GALICYJSKA", d: "Swoboda w zaborze austriackim. Polacy mieli swoje szko≈Çy, urzƒôdy i mogli m√≥wiƒá po polsku." },
        { t: "KRAJ PRZYWI≈öLA≈ÉSKI", d: "Tak Rosjanie nazwali Polskƒô po powstaniu, ≈ºeby wymazaƒá jej nazwƒô z mapy." },
        { t: "PRACA ORGANICZNA", d: "Dzia≈Çanie dla dobra kraju poprzez rozw√≥j gospodarki i rolnictwa, a nie przez walkƒô zbrojnƒÖ." },
        { t: "PRACA U PODSTAW", d: "Edukacja najbiedniejszych ludzi (ch≈Çop√≥w), ≈ºeby nar√≥d by≈Ç silniejszy." },
        { t: "RUGI PRUSKIE", d: "Masowe wyrzucanie Polak√≥w z ziemi przez Niemc√≥w, je≈õli nie mieli obywatelstwa." },
        { t: "STA≈ÉCZYCY", d: "Politycy w Galicji, kt√≥rzy byli lojalni wobec cesarza Austrii. Chcieli zgody, a nie powsta≈Ñ." },
        { t: "KATORGA", d: "Ciƒô≈ºka praca fizyczna na zes≈Çaniu (Syberia), kara dla powsta≈Ñc√≥w." }
    ];

    // --- DANE: TEST ---
    const questions = [
        { q: "Jak Rosjanie nazwali Polskƒô po upadku powstania?", a: ["Kraj Przywi≈õla≈Ñski", "Nowa Rosja", "Kr√≥lestwo Polskie", "Polonia"], c: 0 },
        { q: "Kto by≈Ç symbolem rusyfikacji w szko≈Çach (z≈Çy kurator)?", a: ["Apuchtin", "Bismarck", "Traugutt", "Car Miko≈Çaj"], c: 0 },
        { q: "Co to jest KATORGA?", a: ["Ciƒô≈ºkie roboty na Syberii", "Wakacje w Rosji", "Rodzaj ta≈Ñca", "Nazwa statku"], c: 0 },
        { q: "Kim by≈Ç Aleksander Sochaczewski?", a: ["Malarzem zes≈Ça≈Ñc√≥w syberyjskich", "Genera≈Çem", "Pisarzem", "Rolnikiem"], c: 0 },
        { q: "Co to by≈Ça 'Najd≈Çu≈ºsza wojna nowoczesnej Europy'?", a: ["Walka gospodarcza Polak√≥w z Niemcami", "Powstanie zbrojne", "I Wojna ≈öwiatowa", "Wojna stuletnia"], c: 0 },
        { q: "Kim by≈Ç Hipolit Cegielski?", a: ["Przemys≈Çowcem (fabryka maszyn w Poznaniu)", "Genera≈Çem", "PoetƒÖ", "Urzƒôdnikiem"], c: 0 },
        { q: "Co robi≈Ça Komisja Kolonizacyjna?", a: ["Wykupowa≈Ça ziemiƒô dla Niemc√≥w", "Budowa≈Ça polskie szko≈Çy", "Pomaga≈Ça rolnikom", "Sadzi≈Ça lasy"], c: 0 },
        { q: "Kto og≈Çosi≈Ç KULTURKAMPF?", a: ["Otto von Bismarck", "Cesarz Franciszek J√≥zef", "Micha≈Ç Drzyma≈Ça", "Hipolit Cegielski"], c: 0 },
        { q: "O co strajkowa≈Çy dzieci we Wrze≈õni (1901)?", a: ["O religiƒô po polsku", "O d≈Çu≈ºsze przerwy", "O darmowe obiady", "O nowe mundurki"], c: 0 },
        { q: "Jak protestowa≈Ç Micha≈Ç Drzyma≈Ça?", a: ["Mieszka≈Ç w wozie cyrkowym", "Zorganizowa≈Ç powstanie", "Napisa≈Ç wiersz", "Wyjecha≈Ç do USA"], c: 0 },
        { q: "Gdzie Polacy mieli AUTONOMIƒò (swobodƒô)?", a: ["W Galicji (Austrii)", "W Prusach", "W Rosji", "W Berlinie"], c: 0 },
        { q: "Co to by≈Ça 'Nƒôdza Galicyjska'?", a: ["Wielka bieda na wsi w zaborze austriackim", "Bogactwo", "Nazwa potrawy", "Choroba"], c: 0 }
    ];

    // --- AUDIO SKRYPTY ---
    const scripts = {
        intro: "Cze≈õƒá Juleczko! Dzisiaj lekcja historii, ale bez nudy. Cofniemy siƒô do czas√≥w, gdy Polski nie by≈Ço na mapie. Zaborcy robili wszystko, ≈ºeby nas zniszczyƒá, ale Polacy mieli swoje sposoby. Najpierw nauczymy siƒô pojƒôƒá, ≈ºeby≈õ wiedzia≈Ça, o co chodzi z tƒÖ pracƒÖ organicznƒÖ i kulturkampfem. Gotowa? Startujemy z fiszkami!",
        
        summary: "≈öwietnie Ci idzie! Zanim wejdziesz na ring testowy, zr√≥bmy szybki przeglƒÖd mapy. W zaborze ROSYJSKIM by≈Ç terror, rusyfikacja i zsy≈Çki na Sybir (Katorga). W zaborze PRUSKIM (Niemcy) by≈Ç Kulturkampf, czyli walka z Ko≈õcio≈Çem i wyrzucanie z ziemi (Rugi Pruskie), ale Polacy ≈õwietnie radzili sobie gospodarczo. W GALICJI (Austria) by≈Ça bieda, ale za to wolno≈õƒá ‚Äì polskie szko≈Çy i urzƒôdy. Pamiƒôtaj: Pozytywi≈õci budowali fabryki i uczyli biednych, zamiast walczyƒá karabinem.",
        
        outro: "Brawo Julia! Egzamin zdany celujƒÖco. Wiesz ju≈º, jak Polacy przetrwali najtrudniejsze czasy. Twoja wiedza historyczna jest teraz TwojƒÖ tarczƒÖ. Jestem z Ciebie dumna. Odpocznij!"
    };

    // --- LOGIKA G≈ÅOSU ---
    let voices = [];
    let currentVoiceIndex = 0;

    function initVoices() {
        const allVoices = window.speechSynthesis.getVoices();
        // Filtrujemy tylko polskie g≈Çosy
        voices = allVoices.filter(v => v.lang.includes('pl') || v.lang.includes('PL'));
        
        if (voices.length === 0) {
            document.getElementById('voice-info').innerText = "Wczytujƒô g≈Çosy... (lub brak polskich)";
        } else {
            // Pr√≥ba znalezienia domy≈õlnego Google
            const googleIndex = voices.findIndex(v => v.name.includes('Google'));
            if (googleIndex !== -1) currentVoiceIndex = googleIndex;
            document.getElementById('voice-info').innerText = `Dostƒôpnych g≈Ços√≥w PL: ${voices.length}`;
        }
    }

    // ≈Åadowanie g≈Ços√≥w (Android ≈Çaduje je asynchronicznie)
    window.speechSynthesis.onvoiceschanged = initVoices;
    // Wywo≈Çanie te≈º od razu, na wypadek gdyby ju≈º by≈Çy
    initVoices();

    function toggleVoice() {
        if (voices.length <= 1) {
            alert("Tw√≥j telefon ma tylko jeden polski g≈Ços. Sprawd≈∫ ustawienia Androida (Zamiana tekstu na mowƒô).");
            return;
        }
        stopAudio();
        currentVoiceIndex = (currentVoiceIndex + 1) % voices.length;
        
        const utterance = new SpeechSynthesisUtterance("Pr√≥ba mikrofonu, raz, dwa, trzy.");
        utterance.voice = voices[currentVoiceIndex];
        utterance.lang = 'pl-PL';
        window.speechSynthesis.speak(utterance);
        
        document.getElementById('voice-info').innerText = `Wybrano: ${voices[currentVoiceIndex].name}`;
    }

    // --- LOGIKA NAUKI ---
    let fcIndex = 0;
    let qIndex = 0;
    let shuffledQ = [];

    // Nawigacja
    function goToFlashcards() {
        stopAudio();
        document.getElementById('step-start').classList.add('hidden');
        document.getElementById('step-flashcards').classList.remove('hidden');
        loadFlashcard();
    }
    function goToSummary() {
        stopAudio();
        document.getElementById('step-flashcards').classList.add('hidden');
        document.getElementById('step-summary').classList.remove('hidden');
    }
    function startQuiz() {
        stopAudio();
        document.getElementById('step-summary').classList.add('hidden');
        document.getElementById('step-quiz').classList.remove('hidden');
        shuffledQ = questions.sort(() => Math.random() - 0.5);
        loadQuestion();
    }
    function goToEnd() {
        document.getElementById('step-quiz').classList.add('hidden');
        document.getElementById('step-end').classList.remove('hidden');
    }

    // Audio Engine
    function playAudio(type) {
        stopAudio();
        const text = scripts[type];
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'pl-PL';
        utterance.rate = 1.0; 
        
        // U≈ºyj wybranego g≈Çosu
        if (voices.length > 0) {
            utterance.voice = voices[currentVoiceIndex];
        }
        
        window.speechSynthesis.speak(utterance);
    }
    function stopAudio() { window.speechSynthesis.cancel(); }

    // Fiszki
    function loadFlashcard() {
        const c = document.getElementById('card');
        c.classList.remove('flipped');
        setTimeout(() => {
            document.getElementById('fc-term').innerText = flashcards[fcIndex].t;
            document.getElementById('fc-def').innerText = flashcards[fcIndex].d;
        }, 300);
    }
    function flipCard() {
        document.getElementById('card').classList.toggle('flipped');
        if(document.getElementById('card').classList.contains('flipped')) {
            const u = new SpeechSynthesisUtterance(flashcards[fcIndex].d);
            u.lang = 'pl-PL';
            if (voices.length > 0) u.voice = voices[currentVoiceIndex];
            window.speechSynthesis.speak(u);
        } else { stopAudio(); }
    }
    function nextCard() {
        stopAudio();
        fcIndex = (fcIndex + 1) % flashcards.length;
        loadFlashcard();
    }

    // Quiz
    function loadQuestion() {
        if(qIndex >= shuffledQ.length) { goToEnd(); return; }
        
        const q = shuffledQ[qIndex];
        document.getElementById('progress').innerText = `Pytanie ${qIndex+1} z ${shuffledQ.length}`;
        document.getElementById('q-text').innerText = q.q;
        document.getElementById('feedback').innerText = "";
        document.getElementById('next-q-btn').classList.add('hidden');

        const grid = document.getElementById('q-options');
        grid.innerHTML = "";
        
        const answers = q.a.map((txt, i) => ({txt, ok: i === q.c})).sort(() => Math.random() - 0.5);
        
        answers.forEach(ans => {
            const btn = document.createElement('button');
            btn.className = 'quiz-btn';
            btn.innerText = ans.txt;
            btn.onclick = () => checkAnswer(ans.ok, btn, answers);
            grid.appendChild(btn);
        });
    }

    function checkAnswer(isOk, btn, allAnswers) {
        const btns = document.querySelectorAll('.quiz-btn');
        btns.forEach(b => b.onclick = null);

        if(isOk) {
            btn.classList.add('correct');
            document.getElementById('feedback').innerText = "Tak jest! Prawda historyczna! ‚úÖ";
            document.getElementById('feedback').style.color = "green";
        } else {
            btn.classList.add('wrong');
            btns.forEach(b => {
                if(allAnswers.find(a => a.txt === b.innerText).ok) b.classList.add('correct');
            });
            document.getElementById('feedback').innerText = "Niestety nie. Sp√≥jrz na zielone.";
            document.getElementById('feedback').style.color = "#c62828";
        }
        document.getElementById('next-q-btn').classList.remove('hidden');
    }

    function nextQuestion() {
        qIndex++;
        loadQuestion();
    }

    // Init
    loadFlashcard();

</script>

</body>
</html>
